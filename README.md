## Web-Server
__í´ë¼ì´ì–¸íŠ¸ <-> ì„œë²„ <-> ë°±ì•¤ë“œ <-> DB__
  |í´ë¼ì´ì–¸íŠ¸|ì„œë²„|ë°±ì•¤ë“œ|DB|
  |:---:|:---:|:---:|:---:|
  |Android|Apache2|PHP|MariaDB|
  |iOS|Nginx|NodeJS|MongoDB|
  |Web|Tomcat|Django||
  |Game|Express|ASP||
  |||Spring||
  |||GSP||
  
__í”„ë¡œí† ì½œ ì •ë¦¬__

  |Protocol|Port|ìœ í˜•|ì ‘ê·¼ë°©ì‹|
  |:---:|:---:|:---:|:---:|
  |HTTP|80|Client||
  |HTTPS|443|Client||
  |SSH|22|ê´€ë¦¬ì|í„°ë¯¸ë„|
  |SFTP|22|ê´€ë¦¬ì|íŒŒì¼ì „ì†¡|
  |FTP|21|ê´€ë¦¬ì|íŒŒì¼ì „ì†¡|
  |MySQL|3306|ê´€ë¦¬ì|DB|
  
## OS
  Ubuntu 20.04.3
  1. ìš°ë¶„íˆ¬ ë°ìŠ¤í¬íƒ‘ 
  > https://ubuntu.com/download/desktop
  > 'Ubuntu 20.04.3 LTS' ë‹¤ìš´ë¡œë“œ
  
  2. ìš°ë¶„íˆ¬ ì„œë²„ 
  > https://ubuntu.com/download/server 
  > 'Option 2: Manual server installation'ì„ í´ë¦­í•´ì„œ 'Download ubuntu server 20.04.3 LTS' ë‹¤ìš´ 
  
  3. PuTTY 
  > https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
  > ë³¸ì¸ì€ 'putty.exe' 64-bit x86ì„ ë°›ì•˜ë‹¤
  
## Ubuntu Server
  1. rootë¡œ ì ‘ê·¼   
    -$ sudo su   
  2. apt ì—…ë°ì´íŠ¸   
    -$ apt-get update   
  3. MariaDB ì„¤ì¹˜   
    '''   
    $ apt install mariadb-server   
    $ Y    
    $ systemctl status mariadb (mariadb ìƒíƒœ í™•ì¸)    
    $ mysql_secure_installation (mysqlì´ ë§ë‹¤. mariadb ì•„ë‹ˆë¼ê³  ë‹¹í™©í•˜ì§€ ë§ˆì‹œê¸¸)    
    $ root ê³„ì • ë¹„ë°€ë²ˆí˜¸ ë¬¼ìŒ ì‹œ, ê³„ì • ë¹„ë°€ë²ˆí˜¸ ì…ë ¥    
    $ Y ( set root password? )    
    $ ë¹„ë°€ë²ˆí˜¸, ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì…ë ¥   
    $ Y ( remove anonymous users? )   
    $ Y ( disallow root login remotely? )   
    $ Y ( remove test dtabase and access to it? )   
    $ Y ( Reload privilege tables now? )   
    $ sudo mysql -u root -p ( mariadb ë¹„ë°€ë²ˆí˜¸ ì„¤ì •. ê·¸ë¦¬ê³  ì…ë ¥ëœ mysqlì´ ë§ë‹¤. mariadb ì•„ë‹ˆë¼ê³  ë‹¹í™©í•˜ì§€ ë§ˆì‹œê¸¸ )   
    $ exit ( MariaDB ëª¨ë‹ˆí„°ì—ì„œ ë¹ ì ¸ë‚˜ì˜¤ëŠ” ì»¤ë§¨ë“œ )   
    '''
  4. Nginx ì„¤ì¹˜   
    -$ apt-get install nginx      
  5. Nginx ìƒíƒœ í™•ì¸   
    -$ systemctl status nginx (Nginxì˜ ìƒíƒœë¥¼ ë³´ì—¬ì£¼ëŠ” ì»¤ë§¨ë“œ)      
    -$ q (Nginx ìƒíƒœì°½ì—ì„œ ë‚˜ì˜¤ê²Œí•˜ëŠ” ì»¤ë§¨ë“œ)      
    
  6. Nginxë¥¼ ìœ„í•´ Port(í¬íŠ¸) ì—´ì–´ì£¼ê¸°    
    - VirtualBox       
    - í•´ë‹¹ ìš°ë¶„íˆ¬ ì„œë²„ 'ì„¤ì •(S)'      
    - ê³ ê¸‰(D)      
    - í¬íŠ¸ í¬ì›Œë”©(P)      
    - 'ìƒˆ í¬íŠ¸ í¬ì›Œë”© ê·œì¹™ ì¶”ê°€' í´ë¦­      
    - í˜¸ìŠ¤íŠ¸ í¬íŠ¸ & ê²ŒìŠ¤íŠ¸ í¬íŠ¸ = 80 ìœ¼ë¡œ ì¶”ê°€ (80ë²ˆì€ HTTPë¥¼ ìœ„í•œê²ƒ)      
    - 'ìƒˆ í¬íŠ¸ í¬ì›Œë“œ ê·œì¹™ ì¶”ê°€' í´ë¦­    
    - í˜¸ìŠ¤íŠ¸ í¬íŠ¸ & ê²ŒìŠ¤íŠ¸ í¬íŠ¸ = 22 ìœ¼ë¡œ ì¶”ê°€ (22ë²ˆì€ SSHë¥¼ ìœ„í•œê²ƒ)    
  7. ì›¹ì‚¬ì´íŠ¸ì— '127.0.0.1' ì´ë™
  8. ì›¹ì‚¬ì´íŠ¸ì— 'Welcome to Nginx' í…ìŠ¤íŠ¸ ì¶œë ¥ë¨
  9. Node.jsì„¤ì¹˜   
    -$ apt-get install nodejs (nodejs ì„¤ì¹˜ ì»¤ë§¨ë“œ)    
    -$ y (ì„¤ì¹˜ ìŠ¹ë‚™)    
    -$ node -v (Node.js ë²„ì „í™•ì¸. ë‚˜ëŠ” 2021-10-17ê¸°ì¤€ìœ¼ë¡œ v10.19.0ì´ ë‹¤ìš´ë˜ì–´ìˆë‹¤)    
    -$ curl -sL https://deb.nodesource.com/setup_14.x -o nodesource_14_setup.sh (ì•„ë§ˆ ë””ë ‰í† ë¦¬ê°€ ì—†ë‹¤ê³  ëœ°êº¼ë‹¤)    
    -$ bash nodesource ê¹Œì§€ë§Œ íƒ€ì´í•‘ -> Tabí‚¤ ëˆ„ë¥´ê¸° -> ì—”í„°  (ì—¬ê¸°ê¹Œì§€ê°€ PPAë“±ë¡ì´ë‹¤)     
    -$ apt-get install nodejs (nodejs í•œë²ˆ ë” ì„¤ì¹˜)     
    -$ node -v (2021-10-17ê¸°ì¤€ìœ¼ë¡œ v14.18.1 ë²„ì „ ì„¤ì¹˜ ì™„ë£Œ í™•ì¸)     
    -$ npm -v (2021-10-17ê¸°ì¤€ìœ¼ë¡œ npmë²„ì „ì€ 6.14.15 ë²„ì „ ì„¤ì¹˜ ì™„ë£Œ í™•ì¸)    
  10. MariaDB ì™¸ë¶€ì ‘ì†    
    $ mariadb -u root -p
    $ create user 'ì‚¬ìš©ìì´ë¦„'@'%' identified by 'ë¹„ë°€ë²ˆí˜¸'; (í´ë¼ì´ì–¸íŠ¸ ìƒì„± + ë¹„ë°€ë²ˆí˜¸ ì„¤ì •, ì‘ì€ ë”°ìš¤í‘œ(')ê°€ ìˆë‹¤)
    $ create database ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„; (DB ìƒˆë¡œ í•˜ë‚˜ ìƒì„±, ì‘ì€ ë”°ì˜´í‘œ(')ê°€ ì—†ë‹¤)
    $ grant all privileges on ë°ì´í„°ë² ì´ìŠ¤ì´ë¦„.* to 'ì‚¬ìš©ìì´ë¦„'@'%';
    $ flush privileges; (ë³€ê²½ì‚¬í•­ ì €ì¥)
    $ exit (mariadbì—ì„œ ë¡œê·¸ì•„ì›ƒ)
    $ vi /etc/mysql/mariadb.conf.d/50-server.cnf
    $ 'bind-address - 127.0.0.1' ë¶€ë¶„ì— ì»¤ì„œë¥¼ ì˜®ê¸°ê³  'i'ë¥¼ ëˆ„ë¥¸ë‹¤
    $ # (ië¥¼ ëˆ„ë¥´ë©´ insertëª¨ë“œë¡œ ë³€í™˜ë˜ëŠ”ë° ë§¨ ì•ì— #ì„ ë¶™íˆë©´ í•´ë‹¹ ë¼ì¸ì€ ì£¼ì„ì²˜ë¦¬ê°€ ëœë‹¤)
    $ ESC
    $ :wq! (vi í¸ì§‘ê¸°ì—ì„œ íƒˆì¶œ)
    $ service mariadb restart (mariadb ì¬ì‹œì‘)
    



  9. dateë¥¼ ì…ë ¥í•˜ë©´ UTCê¸°ì¤€ìœ¼ë¡œ ë‚˜ì˜¤ëŠ”ë°, í•œêµ­ ê¸°ì¤€ìœ¼ë¡œ ë³€ê²½í•´ë³´ì
  > sudo timedatectl set-timezone "Asia/Seoul"
  10. ìˆœì •ìƒíƒœ ë°±ì—…
  > VirtualBoxì—ì„œ íŒŒì¼ -> ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°.
  >  -> ì—¬ê¸°ì„œ ì´ë¯¸ì§€ë¼ëŠ”ê²Œ ìš°ë¶„íˆ¬ ì„œë²„ ê·¸ ìì²´ì¸ ê²ƒ ê°™ë‹¤.
  >  í•˜ì—¬ 'ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°'ëŠ” í˜„ì¬ ìš°ë¶„íˆ¬ ì„œë²„ í˜„ì¬ ìƒíƒœë¥¼ ê·¸ë˜ë„ ë³µì‚¬í•˜ì—¬ ì €ì¥í•˜ëŠ” ê²ƒ ê°™ìŒ.
  11. íŒ¨í‚¤ì§€ í™•ì¸
  > dpkg -l | grep  ssh  (-1ì€ ìˆ«ì 1ì´ ì•„ë‹ˆë¼ ì†Œë¬¸ì Lì´ë©°, |ì€ ì—”í„° ìœ„ 'ì›í™”' ë˜ëŠ” '\'ì˜ shiftë²„ì „)
  12. sshì ‘ì†
  > ìœ„ ê³¼ì • ì¤‘ ë¡œê·¸ì—ì„œ 'openssh-server'ì´ ì°íˆì§€ ì•ŠëŠ”ë‹¤ë©´, ì•„ë˜ì™€ ê°™ì€ ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•´ì„œ ì„¤ì¹˜í•œë‹¤.
  > sudo apt -y install openssh-server
  > ì´í›„ì— sshì ‘ì† ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•´ì¤€ë‹¤
  > sudo systemctl start ssh
  13. í•œê¸€íŒ© ì¶”ê°€
  > sudo apt -y install language-pack-ko
  14. í•œê¸€íŒ© í™œì„±í™”
  > sudo update-locale LANG=ko_KR.UTF-8 LC_MESSAGES=POSIX
  > ì„¸ì…˜ ë³€ê²½(ë¡œê·¸ì¸ ë‹¤ì‹œ í•˜ë©´ ë¨)
  15. rootê¶Œí•œìœ¼ë¡œ ë³€ê²½
  > sudo -i // rootê¶Œí•œì—ì„œ ë¹ ì ¸ë‚˜ì˜¤ë ¤ë©´ 'logout' ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•˜ë©´ ëœë‹¤
  16. root ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
  > sudo passwd root
  17. sudoë¥¼ ë§¤ë²ˆ ì“°ê¸° ê·€ì°®ì„ ë•Œ?
  > su - (ì…ë ¥í›„ì— ë‹¤ë¥¸ sudo ì»¤ë§¨ë“œ ì‚¬ìš© í•  ë•Œì—,  sudoë¥¼ ë¶™íˆì§€ ì•Šì•„ë„ ëœë‹¤)
  
  
  
  
## Apache2 vs Nginx
  ### ë¬´ì—‡ì´ ë‹¤ë¥¸ê°€?
  __â—¼ Apache__
  1. Client ì ‘ì†ë§ˆë‹¤ Process í˜¹ì€ Threadë¥¼ ìƒì„±í•˜ëŠ” êµ¬ì¡°.
    = Client ê°¯ìˆ˜ â¬† -> CPU ì‚¬ìš©ëŸ‰ â¬†, Memory ì‚¬ìš©ëŸ‰ â¬† 
  2. í”„ë¡œì„¸ìŠ¤ê°€ 'Blocking' ë  ë•Œ ì´ì „ì— ìš”ì²­ëœ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°ìƒíƒœ.
    = í•´ê²°ë°©ì•ˆìœ¼ë¡œëŠ” Keep Aliveë¥¼ í™œì„±í™”í•˜ë©´ ë˜ì§€ë§Œ, KeepAliveëŠ” ëŒ€ëŸ‰ ì ‘ì† ì‹œ íš¨ìœ¨ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§.

  âš  'Keep Alive'ì´ ë­ì•¼?
  > HTTP í”„ë¡œí† ì½œì˜ íŠ¹ì„±ìƒ í•œ ë²ˆ í†µì‹ ì´ ì´ë£¨ì–´ì§€ë©´ ì ‘ì†ì„ ëŠì–´ ë²„ë¦¬ì§€ë§Œ, 
  > KeepAlive Onìƒíƒœì—ì„œëŠ” KeepAliveTimeOutì‹œê°„ ë™ì•ˆ ì ‘ì†ì„ ëŠì§€ ì•Šê³  ë‹¤ìŒ ì ‘ì†ì„ ê¸°ë‹¤ë¦°ë‹¤.
  > ì¦‰, í•œ ë²ˆ ì—°ê²°ëœ Clientì™€ í†µì‹ ì„ ìœ ì§€í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, 
  > ë‹¤ìŒ í†µì‹  ì‹œì— Connectionì„ ìƒì„±í•˜ê³  ëŠëŠ” ì‘ì—…ì´ í•„ìš” ì—†ê²Œ ëœë‹¤.

  __â—¼ Nginx__
  1. 'Event-Driven'ë°©ì‹. 
  2. í•œ ê°œ ë˜ëŠ” ê³ ì •ëœ Processë§Œ ìƒì„±, ê·¸ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸°ë¡œ íš¨ìœ¨ì ì¸ ë°©ì‹ìœ¼ë¡œ Taskë¥¼ ì²˜ë¦¬.
    = Client ê°¯ìˆ˜ â¬† -> ì¶”ê°€ì ì¸ ìƒì„±ë¹„ìš©(CPU, Memory) ğŸ™…ğŸ»â€â™‚ï¸
  3. 'Context Switching' ë¹„ìš©ì´ ì ë‹¤.
  4. ë¹„ë™ê¸° ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ìš”ì²­.
  5. Apacheì™€ ë‹¬ë¦¬ CPUì™€ ê´€ê³„ì—†ì´ I/Oë“¤ì„ ì „ë¶€ Event  Listenerë¡œ ë¯¸ë£¨ê¸° ë•Œë¬¸ì— íë¦„ ëŠê¹€ì´ ì—†ë‹¤.
  6. ë³´ì•ˆì— ëŒ€í•´ ìš°ìˆ˜í•˜ë‹¤.
    = ì• ë‹¨ì˜ Nginxë¡œ reverse proxyë¡œ ì‚¬ìš©í•˜ê³  ë’· ë‹¨ì—ëŠ” WASë¥¼ ì„¤ì¹˜í•˜ì—¬,
    ì™¸ë¶€ì— ë…¸ì¶œë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ Nginx WAS ë¶€ë¶„ë§Œ ë…¸ì¶œê°€ëŠ¥í•˜ë‹¤. 
    IF) ì‚¬ìš©ìê°€ ì§ì ‘ì ì¸ WebServerë¡œì˜ ì ‘ê·¼ì„ í•œë‹¤ë¼ê³  í•˜ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
        ì§ì ‘ì ì´ì§€ ì•Šê³  í•œ ë‹¨ê³„ë¥¼ ë” ê±°ì¹¨ìœ¼ë¡œì¨ ë³´ì•ˆì ì¸ ë¶€ë¶„ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
  7. Backend-Service ì¥ì•  ëŒ€ì‘ì²˜ë¦¬.
    = Backend-serviceì— ëŒ€í•´ max fails, fail timeoutì‹œ ë°±ì—… ì„œë²„ë¡œ ì§„ì…í•  ìˆ˜ ì‡ë„ë¡ ì²˜ë¦¬ê°€ëŠ¥.
  8. Moduleë¡œ êµ¬ì„±
  9. Single-Threaded(Worker Process)
  

  âš 'Context Switching'ì´ ë­ì•¼?
  > ContextëŠ” Threadê°€ Task(ì‘ì—…)ì„ ì§„í–‰í•˜ëŠ” ë™ì•ˆ ì‘ì—…ì •ë¥¼ ë³´ê´€í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. 
  > OSëŠ” Aì‘ì—…ì„ ì§„í–‰í•  ë•Œ A Threadì˜ Contextë¥¼ ì½ì–´ì˜¤ë©°,
  >  B Threadë¡œ ì „í™œ í•  ë•Œì—ëŠ” A Threadì˜ Contextë¥¼ ì €ì¥í•˜ê³  B Threadì˜ Contextë¥¼ ì½ì–´ì˜¤ëŠ” ë°˜ë³µì‘ì—…ì„ í•œë‹¤.
  >  ì¦‰, Thread ê°¯ìˆ˜ê°€ ë§ì•„ì§ˆ ìˆ˜ë¡ Context Switching ì‘ì—…ì€ ë” ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ë©° ì„±ëŠ¥ ì €í•˜ë¥¼ ì•¼ê¸°í•œë‹¤.
  
  __Apacche & Nginx ì¥ì __

  ||Apache2|Nginx|
  |:---:|:---:|:---:|
  |ì„±ëŠ¥||ğŸ‘|
  |ë³´ì•ˆ||ğŸ‘|
  |ëª¨ë“ˆ|ğŸ‘||
  |ì•ˆì •ì„±|ğŸ‘||
  |í™•ì¥ì„±|ğŸ‘||
  |í˜¸í™˜ì„±|ğŸ‘||
  |ìœ ì§€ë³´ìˆ˜|ğŸ‘||

  __Nginx ì‚¬ìš©__
  - ë¡œë“œ ë°¸ëŸ°ì„œ
    - íš¨ìœ¨ì„±
    - ì•ˆì •ì„±(ëˆ„êµ°ê°€ ì£½ì–´ë„ ë‹¤ë¥¸ì• ê°€ ìˆë‹¤)
  - Reverse Proxy
    - ë³´ì•ˆ
    - ìœ ì—°ì„± (ì™¸ë¶€ì—ì„œ ì§ì ‘ì ìœ¼ë¡œ ëª¨ë¥´ê¸°ì—)
    - ë ˆì´í„´ì‹œ ê°ì†Œ
      - ì••ì¶•
      - SSL (ì•”í˜¸í™”)
      - ìºì‹œ
  __HTTPS__
  - 'Let's Encrypt'ì—ì„œ 3ê°œì›”ì§œë¦¬ ë¬´ë£Œ ë¼ì´ì„¼ìŠ¤ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ”ë°, 3ê°œì›” í›„ì—” ìë™ìœ¼ë¡œ ì¸ì¦ì„œ ê°±ì‹ ì„ í†µí•´ í‰ìƒ ë¬´ë£Œë¡œ ì“°ì
  > 'Let's encrypt' url = https://letsencrypt.org/ko/

ì°¸ê³ í•œ ë§í¬
1. https://victorydntmd.tistory.com/231 
2. https://velog.io/@ksso730/Nginx-Apache-%EB%B9%84%EA%B5%90
3. https://www.youtube.com/watch?v=QeBqwwbsBbM
