## Web-Server
í´ë¼ì´ì–¸íŠ¸ <-> ì„œë²„ <-> ë°±ì•¤ë“œ <-> DB
í´ë¼ì´ì–¸íŠ¸ : Android, iOS, Web, Game
ì„œë²„ : Apache,Nginx, Tomcat, Express
BackEnd : ASP, GSP, PHP, NodeJS, Django, Spring
DB : MariaDB, MongoDB
  |í´ë¼ì´ì–¸íŠ¸|ì„œë²„|ë°±ì•¤ë“œ|DB|
  |:---:|:---:|:---:|:---:|:---:|
  |Android|Apache2|PHP|MariaDB|
  |iOS|Nginx|NodeJS|MongoDB|
  |Web|Tomcat|Django||
  |Game|Express|ASP||
  ||GSP||
  |||Spring||
í”„ë¡œí† ì½œ ì •ë¦¬
  |Protocol|Port|
  |:---:|:---:|
  |HTTP|80|
  |HTTPS|443|
  |SSH|22|
  |SFTP|22|
  |FTP|21|
  |MySQL|3306|
  
## OS
  Ubuntu 20.04.3
  1. ìš°ë¶„íˆ¬ ë°ìŠ¤í¬íƒ‘ 
  > https://ubuntu.com/download/desktop
  > 'Ubuntu 20.04.3 LTS' ë‹¤ìš´ë¡œë“œ
  
  2. ìš°ë¶„íˆ¬ ì„œë²„ 
  > https://ubuntu.com/download/server 
  > 'Option 2: Manual server installation'ì„ í´ë¦­í•´ì„œ 'Download ubuntu server 20.04.3 LTS' ë‹¤ìš´ 
  
  3. PuTTY 
  > https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
  > ë³¸ì¸ì€ 'putty.exe' 64-bit x86ì„ ë°›ì•˜ë‹¤
  
## Ubuntu Server
  1. dateë¥¼ ì…ë ¥í•˜ë©´ UTCê¸°ì¤€ìœ¼ë¡œ ë‚˜ì˜¤ëŠ”ë°, í•œêµ­ ê¸°ì¤€ìœ¼ë¡œ ë³€ê²½í•´ë³´ì
  > sudo timedatectl set-timezone "Asia/Seoul"
  2. ìˆœì •ìƒíƒœ ë°±ì—…
  > VirtualBoxì—ì„œ íŒŒì¼ -> ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°.
  >  -> ì—¬ê¸°ì„œ ì´ë¯¸ì§€ë¼ëŠ”ê²Œ ìš°ë¶„íˆ¬ ì„œë²„ ê·¸ ìì²´ì¸ ê²ƒ ê°™ë‹¤.
  >  í•˜ì—¬ 'ì´ë¯¸ì§€ ë‚´ë³´ë‚´ê¸°'ëŠ” í˜„ì¬ ìš°ë¶„íˆ¬ ì„œë²„ í˜„ì¬ ìƒíƒœë¥¼ ê·¸ë˜ë„ ë³µì‚¬í•˜ì—¬ ì €ì¥í•˜ëŠ” ê²ƒ ê°™ìŒ.
  3. íŒ¨í‚¤ì§€ í™•ì¸
  > dpkg -l | grep  ssh  (-1ì€ ìˆ«ì 1ì´ ì•„ë‹ˆë¼ ì†Œë¬¸ì Lì´ë©°, |ì€ ì—”í„° ìœ„ 'ì›í™”' ë˜ëŠ” '\'ì˜ shiftë²„ì „)
  4. sshì ‘ì†
  > ìœ„ ê³¼ì • ì¤‘ ë¡œê·¸ì—ì„œ 'openssh-server'ì´ ì°íˆì§€ ì•ŠëŠ”ë‹¤ë©´, ì•„ë˜ì™€ ê°™ì€ ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•´ì„œ ì„¤ì¹˜í•œë‹¤.
  > sudo apt -y install openssh-server
  > ì´í›„ì— sshì ‘ì† ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•´ì¤€ë‹¤
  > sudo systemctl start ssh
  5. í•œê¸€íŒ© ì¶”ê°€
  > sudo apt -y install language-pack-ko
  6. í•œê¸€íŒ© í™œì„±í™”
  > sudo update-locale LANG=ko_KR.UTF-8 LC_MESSAGES=POSIX
  > ì„¸ì…˜ ë³€ê²½(ë¡œê·¸ì¸ ë‹¤ì‹œ í•˜ë©´ ë¨)
  7. rootê¶Œí•œìœ¼ë¡œ ë³€ê²½
  > sudo -i // rootê¶Œí•œì—ì„œ ë¹ ì ¸ë‚˜ì˜¤ë ¤ë©´ 'logout' ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•˜ë©´ ëœë‹¤
  8. root ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
  > sudo passwd root
  9. sudoë¥¼ ë§¤ë²ˆ ì“°ê¸° ê·€ì°®ì„ ë•Œ?
  > su - (ì…ë ¥í›„ì— ë‹¤ë¥¸ sudo ì»¤ë§¨ë“œ ì‚¬ìš© í•  ë•Œì—,  sudoë¥¼ ë¶™íˆì§€ ì•Šì•„ë„ ëœë‹¤)
  
  
  
  
## Apache2 vs Nginx
  ### ë¬´ì—‡ì´ ë‹¤ë¥¸ê°€?
  __â—¼ Apache__
  1. Client ì ‘ì†ë§ˆë‹¤ Process í˜¹ì€ Threadë¥¼ ìƒì„±í•˜ëŠ” êµ¬ì¡°.
    = Client ê°¯ìˆ˜ â¬† -> CPU ì‚¬ìš©ëŸ‰ â¬†, Memory ì‚¬ìš©ëŸ‰ â¬† 
  2. í”„ë¡œì„¸ìŠ¤ê°€ 'Blocking' ë  ë•Œ ì´ì „ì— ìš”ì²­ëœ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°ìƒíƒœ.
    = í•´ê²°ë°©ì•ˆìœ¼ë¡œëŠ” Keep Aliveë¥¼ í™œì„±í™”í•˜ë©´ ë˜ì§€ë§Œ, KeepAliveëŠ” ëŒ€ëŸ‰ ì ‘ì† ì‹œ íš¨ìœ¨ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§.

  âš  'Keep Alive'ì´ ë­ì•¼?
  > HTTP í”„ë¡œí† ì½œì˜ íŠ¹ì„±ìƒ í•œ ë²ˆ í†µì‹ ì´ ì´ë£¨ì–´ì§€ë©´ ì ‘ì†ì„ ëŠì–´ ë²„ë¦¬ì§€ë§Œ, 
  > KeepAlive Onìƒíƒœì—ì„œëŠ” KeepAliveTimeOutì‹œê°„ ë™ì•ˆ ì ‘ì†ì„ ëŠì§€ ì•Šê³  ë‹¤ìŒ ì ‘ì†ì„ ê¸°ë‹¤ë¦°ë‹¤.
  > ì¦‰, í•œ ë²ˆ ì—°ê²°ëœ Clientì™€ í†µì‹ ì„ ìœ ì§€í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, 
  > ë‹¤ìŒ í†µì‹  ì‹œì— Connectionì„ ìƒì„±í•˜ê³  ëŠëŠ” ì‘ì—…ì´ í•„ìš” ì—†ê²Œ ëœë‹¤.

  __â—¼ Nginx__
  1. 'Event-Driven'ë°©ì‹. 
  2. í•œ ê°œ ë˜ëŠ” ê³ ì •ëœ Processë§Œ ìƒì„±, ê·¸ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸°ë¡œ íš¨ìœ¨ì ì¸ ë°©ì‹ìœ¼ë¡œ Taskë¥¼ ì²˜ë¦¬.
    = Client ê°¯ìˆ˜ â¬† -> ì¶”ê°€ì ì¸ ìƒì„±ë¹„ìš©(CPU, Memory) ğŸ™…ğŸ»â€â™‚ï¸
  3. 'Context Switching' ë¹„ìš©ì´ ì ë‹¤.
  4. ë¹„ë™ê¸° ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ìš”ì²­.
  5. Apacheì™€ ë‹¬ë¦¬ CPUì™€ ê´€ê³„ì—†ì´ I/Oë“¤ì„ ì „ë¶€ Event  Listenerë¡œ ë¯¸ë£¨ê¸° ë•Œë¬¸ì— íë¦„ ëŠê¹€ì´ ì—†ë‹¤.
  6. ë³´ì•ˆì— ëŒ€í•´ ìš°ìˆ˜í•˜ë‹¤.
    = ì• ë‹¨ì˜ Nginxë¡œ reverse proxyë¡œ ì‚¬ìš©í•˜ê³  ë’· ë‹¨ì—ëŠ” WASë¥¼ ì„¤ì¹˜í•˜ì—¬,
    ì™¸ë¶€ì— ë…¸ì¶œë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ Nginx WAS ë¶€ë¶„ë§Œ ë…¸ì¶œê°€ëŠ¥í•˜ë‹¤. 
    IF) ì‚¬ìš©ìê°€ ì§ì ‘ì ì¸ WebServerë¡œì˜ ì ‘ê·¼ì„ í•œë‹¤ë¼ê³  í•˜ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
        ì§ì ‘ì ì´ì§€ ì•Šê³  í•œ ë‹¨ê³„ë¥¼ ë” ê±°ì¹¨ìœ¼ë¡œì¨ ë³´ì•ˆì ì¸ ë¶€ë¶„ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
  7. Backend-Service ì¥ì•  ëŒ€ì‘ì²˜ë¦¬.
    = Backend-serviceì— ëŒ€í•´ max fails, fail timeoutì‹œ ë°±ì—… ì„œë²„ë¡œ ì§„ì…í•  ìˆ˜ ì‡ë„ë¡ ì²˜ë¦¬ê°€ëŠ¥.
  8. Moduleë¡œ êµ¬ì„±
  9. Single-Threaded(Worker Process)
  

  âš 'Context Switching'ì´ ë­ì•¼?
  > ContextëŠ” Threadê°€ Task(ì‘ì—…)ì„ ì§„í–‰í•˜ëŠ” ë™ì•ˆ ì‘ì—…ì •ë¥¼ ë³´ê´€í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. 
  > OSëŠ” Aì‘ì—…ì„ ì§„í–‰í•  ë•Œ A Threadì˜ Contextë¥¼ ì½ì–´ì˜¤ë©°,
  >  B Threadë¡œ ì „í™œ í•  ë•Œì—ëŠ” A Threadì˜ Contextë¥¼ ì €ì¥í•˜ê³  B Threadì˜ Contextë¥¼ ì½ì–´ì˜¤ëŠ” ë°˜ë³µì‘ì—…ì„ í•œë‹¤.
  >  ì¦‰, Thread ê°¯ìˆ˜ê°€ ë§ì•„ì§ˆ ìˆ˜ë¡ Context Switching ì‘ì—…ì€ ë” ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ë©° ì„±ëŠ¥ ì €í•˜ë¥¼ ì•¼ê¸°í•œë‹¤.
  
  __Apacche & Nginx ì¥ì __

  ||Apache2|Nginx|
  |:---:|:---:|:---:|
  |ì„±ëŠ¥||ğŸ‘|
  |ë³´ì•ˆ||ğŸ‘|
  |ëª¨ë“ˆ|ğŸ‘||
  |ì•ˆì •ì„±|ğŸ‘||
  |í™•ì¥ì„±|ğŸ‘||
  |í˜¸í™˜ì„±|ğŸ‘||
  |ìœ ì§€ë³´ìˆ˜|ğŸ‘||

  __Nginx ì‚¬ìš©__
  - ë¡œë“œ ë°¸ëŸ°ì„œ
    - íš¨ìœ¨ì„±
    - ì•ˆì •ì„±(ëˆ„êµ°ê°€ ì£½ì–´ë„ ë‹¤ë¥¸ì• ê°€ ìˆë‹¤)
  - Reverse Proxy
    - ë³´ì•ˆ
    - ìœ ì—°ì„± (ì™¸ë¶€ì—ì„œ ì§ì ‘ì ìœ¼ë¡œ ëª¨ë¥´ê¸°ì—)
    - ë ˆì´í„´ì‹œ ê°ì†Œ
      - ì••ì¶•
      - SSL (ì•”í˜¸í™”)
      - ìºì‹œ
  __HTTPS__
  - 'Let's Encrypt'ì—ì„œ 3ê°œì›”ì§œë¦¬ ë¬´ë£Œ ë¼ì´ì„¼ìŠ¤ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ”ë°, 3ê°œì›” í›„ì—” ìë™ìœ¼ë¡œ ì¸ì¦ì„œ ê°±ì‹ ì„ í†µí•´ í‰ìƒ ë¬´ë£Œë¡œ ì“°ì
  > 'Let's encrypt' url = https://letsencrypt.org/ko/

ì°¸ê³ í•œ ë§í¬
1. https://victorydntmd.tistory.com/231 
2. https://velog.io/@ksso730/Nginx-Apache-%EB%B9%84%EA%B5%90
3. https://www.youtube.com/watch?v=QeBqwwbsBbM
